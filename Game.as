package {		//imports	import flash.display.Sprite;	import flash.events.Event;	import flash.events.MouseEvent;	import flash.text.TextField;	import flash.net.URLLoader;	import flash.net.URLRequest;		public class Game extends Sprite {				private var _xml:XML;		private var _levels:Array;		private var _numLevel:uint = 0;		private var _gameOver:Boolean;		private var _score:int;				private var _level:Level;		private var _endSprite:Sprite;				public function Game() {			loadXML();		}				private function loadXML():void {			var req:URLRequest = new URLRequest('levels.xml');			var loader:URLLoader = new URLLoader(req);			loader.addEventListener(Event.COMPLETE, xmlComplete);		}				private function xmlComplete(e:Event):void {			_levels = new Array();			_xml = new XML(e.target.data);			for each(var level:XML in _xml.children()) {				_levels.push(new Array(level.@id, level.@required));			}			loadLevel(++_numLevel);			//_gameOver = true;			//levelOverMenu(2343, 2343);					}				private function loadLevel(num:int, score:int = 0):void {			_level = new Level(_levels[num - 1][0], _levels[num - 1][1], score);			addChild(_level);			_level.addEventListener('levelComplete', handleLevelComplete);			_level.addEventListener('gameOver', handleGameOver);		}				private function levelOverMenu(score:int, bonus:int):void {						//create a sprite to hold the menu			_endSprite = new Sprite();						//create the level complete textfield			var levelComplete:TextField = Static.textField('Level complete!', 28);			levelComplete.x = 0;			levelComplete.y = 0;			_endSprite.addChild(levelComplete);									var scoreTf:TextField = Static.textField('Score: ' + score.toString());			scoreTf.y = 30;			scoreTf.x = 40;			_endSprite.addChild(scoreTf);						var bonusTf:TextField = Static.textField('Bonus: ' + bonus.toString());			bonusTf.y = 60;			bonusTf.x = 40;			_endSprite.addChild(bonusTf);						var total_tf:TextField = Static.textField('Total: ' + (bonus + score).toString());			total_tf.y = 90;			total_tf.x = 40;			_endSprite.addChild(total_tf);						var continueTf:TextField = Static.textField('Continue ->', 26);			continueTf.x = 40;			continueTf.y = 120;			continueTf.addEventListener(MouseEvent.CLICK, handleClick);			_endSprite.addChild(continueTf);						var submitTf:TextField = Static.textField('Submit score now ->', 16);			submitTf.x = 40;			submitTf.y = 150;			submitTf.addEventListener(MouseEvent.CLICK, handleSubmit);			_endSprite.addChild(submitTf);						_endSprite.x = (500 / 2) - (_endSprite.width / 2);			_endSprite.y = (300 / 2) - (_endSprite .height / 2);						if(_gameOver == true) {				continueTf.text = 'Submit Score ->';				levelComplete.text = 'Game Over!';				submitTf.text = '';			}			addChild(_endSprite);					}				private function handleLevelComplete(e:Event):void {			_gameOver = false;			levelOverMenu(e.currentTarget.score, e.currentTarget.bonus);		}				private function handleSubmit(e:MouseEvent):void {			_gameOver = true;			removeChild(_level);			removeChild(_endSprite);			_score = _level.score + _level.bonus;			submitScores();		}				private function handleClick(e:MouseEvent):void {			removeChild(_level);			removeChild(_endSprite);			if(_gameOver == false) {				loadLevel(++_numLevel, _level.score + _level.bonus);			} else {				_score = _level.score + _level.bonus;				submitScores();							}		}				private function handleGameOver(e:Event):void {			_gameOver = true;			levelOverMenu(e.currentTarget.score, e.currentTarget.bonus);		}				private function submitScores():void {			dispatchEvent(new Event('submitScoresClicked'));		}				public function get score():int {			return _score;		}					}//end class		}//end package